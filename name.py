import streamlit as st
import pandas as pd
import numpy as np
import os

# =============================
# PAGE CONFIG
# =============================
st.set_page_config(
    page_title="Healicious Kiosk",
    layout="centered",
    page_icon="🥗",
    initial_sidebar_state="expanded",
)

# =============================
# BRAND SECTION (SVG ICON)
# =============================
BRAND_HTML = """
<div style='display:flex; align-items:center; gap:14px; margin-bottom:24px; margin-top:4px;'>
    <img src='data:image/svg+xml;utf8,
    <svg xmlns="http://www.w3.org/2000/svg" width="56" height="56">
        <rect rx="12" width="56" height="56" fill="%236ef0b0"/>
        <text x="50%" y="54%" font-size="30" text-anchor="middle" font-family="Inter" fill="white">H</text>
    </svg>'
    style='height:56px; border-radius:12px;' />
    <div>
        <div style='font-size:30px; font-weight:800; font-family:Inter;'>Healicious</div>
        <div style='font-size:13px; color:#5f6b7a; margin-top:2px;'>Healthy + Delicious 식습관 코치</div>
    </div>
</div>
"""
st.markdown(BRAND_HTML, unsafe_allow_html=True)

# =============================
# CUSTOM UI CSS
# =============================
st.markdown(
    """
<style>
body {
    background: #f5f7fa;
}
.block-container {
    padding-top: 1.5rem;
    padding-bottom: 3rem;
    max-width: 900px;
}
.section-box {
    padding: 20px 22px;
    border-radius: 18px;
    background: white;
    box-shadow: 0 4px 18px rgba(15,23,42,0.05);
    margin-bottom: 18px;
}
.section-title {
    font-size: 20px;
    font-weight: 800;
    margin-bottom: 6px;
}
.section-caption {
    font-size: 13px;
    color: #6b7280;
    margin-bottom: 8px;
}
.badge {
    display:inline-block;
    padding: 2px 8px;
    border-radius:999px;
    font-size:11px;
    background:#ecfdf3;
    color:#15803d;
    margin-right:6px;
}
.badge-danger {
    background:#fef2f2;
    color:#b91c1c;
}
.stButton>button {
    width: 100%;
    background-color: #6ef0b0;
    color: #111827;
    font-weight: 700;
    border-radius: 999px;
    height: 56px;
    font-size: 18px;
    border: none;
}
.stButton>button:hover {
    background-color: #4cd893;
    color: white;
}
.meal-card {
    border-radius: 16px;
    padding: 14px 16px;
    background:#f9fafb;
    margin-bottom:10px;
}
.meal-title {
    font-size:16px;
    font-weight:700;
}
.meal-sub {
    font-size:12px;
    color:#6b7280;
}
.kcal-tag {
    font-size:12px;
    font-weight:600;
    padding:2px 8px;
    border-radius:999px;
    background:#e0f2fe;
    color:#0369a1;
}
.macro-line {
    font-size:12px;
    color:#4b5563;
}
</style>
""",
    unsafe_allow_html=True,
)

# =============================
# LOAD FOOD DATABASE
# =============================
def load_food_database():
    # 기본 DB (식품군 + 대략적인 영양성분)
    default_data = pd.DataFrame(
        {
            "food": [
                "닭가슴살 구이",
                "연어 샐러드",
                "두부 스테이크",
                "현미밥",
                "고구마 구이",
                "야채 스틱 & 후무스",
                "그릭 요거트 & 베리",
                "계란찜",
                "두부김치 (저염)",
                "비빔밥 (채소 듬뿍)",
                "콩나물국",
                "닭가슴살 샐러드랩",
                "국밥_돼지머리",
                "국밥_순대국밥",
                "국밥_콩나물",
                "기장밥",
                "김밥",
                "김밥_김치",
                "김밥_날치알",
                "김밥_돈가스",
                "김밥_소고기",
                "김밥_참치",
                "김밥_채소",
                "김밥_치즈",
                "김밥_풋고추",
                "덮밥_낙지",
                "덮밥_닭고기",
                "덮밥_돼지고기(제육)",
                "덮밥_불고기",
                "덮밥_오징어",
                "보리밥",
                "볶음밥",
                "볶음밥_계란",
                "볶음밥_김치",
                "볶음밥_새우",
                "볶음밥_소고기",
                "볶음밥_참치",
                "볶음밥_채소",
                "볶음밥_표고버섯",
                "비빔밥",
                "비빔밥_돌솥",
                "비빔밥_육회",
                "삼각김밥_참치마요네즈",
                "수수밥",
                "알밥",
                "영양돌솥밥",
                "오므라이스",
                "자장밥",
                "잡곡밥",
                "잡채밥",
                "주먹밥_소고기",
                "짬뽕밥",
                "차조밥",
                "찰밥",
                "초밥_모듬",
                "초밥_유부초밥",
                "카레라이스",
                "콩나물밥",
                "콩밥_검정콩",
                "콩밥_완두콩",
                "하이라이스",
                "현미밥",
                "회덮밥_모듬",
                "가래떡",
                "경단_깨",
                "꿀떡",
                "모듬찰떡",
                "백설기",
                "송편_깨",
                "시루떡",
                "약식",
                "인절미",
                "절편_쑥",
                "증편",
                "찹쌀떡_팥",
                "도넛_링도넛",
                "도넛_찹쌀",
                "마늘빵",
                "머핀",
                "모닝빵",
                "모카빵",
                "베이글",
                "샌드위치_닭가슴살",
                "샌드위치_모듬",
                "샌드위치_참치",
                "샌드위치_채소",
                "샌드위치_햄_달걀",
                "소보로빵",
                "식빵",
                "초코소라빵",
                "츄러스",
                "카스텔라",
                "케이크_롤케이크",
                "케이크_생크림케이크",
                "크로와상",
                "파이/만주_사과파이",
                "페이스트리",
                "피자_콤비네이션피자",
                "피자빵",
                "햄버거",
                "햄버거_불고기버거",
                "호떡_견과류",
                "간자장",
                "국수_막국수",
                "국수_비빔국수",
                "국수_잔치국수",
                "국수_쟁반막국수",
                "냉면_물냉면",
                "냉면_비빔냉면",
                "냉면_회냉면_홍어",
                "떡국",
                "떡만두국",
                "라면",
                "라면_달걀",
                "라면_떡",
                "만두_고기만두",
                "만두_군만두",
                "만두_김치만두",
                "만두_물만두",
                "만두국_사골",
                "메밀국수_온면",
                "수제비",
                "스파게티_미트볼",
                "우동_일식",
                "우동볶음",
                "월남쌈",
                "자장면",
                "짬뽕",
                "쫄면",
                "칼국수",
                "칼국수_바지락",
                "콩국수",
                "닭죽",
                "스프_양송이버섯",
                "오리죽",
                "전복죽",
                "채소죽",
                "팥죽",
                "호박죽",
                "흑임자 죽",
                "갈비탕",
                "감자국",
                "곰탕",
                "곰탕_우거지",
                "굴국_무",
                "김치국",
                "김치국_콩나물",
                "내장탕",
                "냉국_미역",
                "냉국_미역_오이",
                "달걀국",
                "달걀탕_순두부",
                "닭곰탕",
                "도가니탕",
                "된장국_감자",
                "된장국_냉이",
                "된장국_미역",
                "된장국_배추",
                "된장국_시금치",
                "된장국_시래기",
                "된장국_쑥",
                "된장국_아욱",
                "된장국_얼갈이배추",
                "된장국_우거지",
                "된장국_콩나물",
                "된장국_해물",
                "된장국_호박",
                "된장국_호박잎",
                "무국_소고기",
                "무국_홍합",
                "묵국_메밀묵",
                "미역국",
                "미역국_대합",
                "미역국_새우",
                "미역국_소고기",
                "배추국_소고기",
                "북어국",
                "사골국",
                "삼계탕",
                "새우탕",
                "설렁탕",
                "순대국",
                "어묵국(어묵탕)",
                "오징어국",
                "육개장",
                "육개장_닭고기",
                "장어탕",
                "재첩국",
                "조개국",
                "콩나물국",
                "토란국",
                "해장국_뼈다귀",
                "해장국_선지",
                "동태국",
                "갈치찌개",
                "감자탕",
                "김치전골",
                "김치찌개_꽁치",
                "김치찌개_돼지고기",
                "김치찌개_어묵",
                "김치찌개_참치",
                "김치찌개_햄",
                "꽃게탕",
                "낙지전골",
                "동태찌개",
                "돼지고기찌개",
                "된장찌개",
                "된장찌개_냉이",
                "된장찌개_달래",
                "된장찌개_두부",
                "된장찌개_바지락",
                "두부찌개_고추장",
                "두부찌개_소고기_고추장",
                "두부찌개_소고기_된장",
                "매운탕_대구",
                "매운탕_해물",
                "버섯전골",
                "부대찌개",
                "샤브샤브_버섯",
                "샤브샤브_소고기",
                "소고기전골",
                "순두부찌개_김치",
                "알탕",
                "오리백숙",
                "오리탕",
                "오징어찌개",
                "청국장찌개",
                "추어탕",
                "콩비지찌개",
                "호박찌개_고추장",
                "고구마_찐고구마",
                "가오리찜",
                "갈비찜_소고기",
                "감자_찐감자",
                "깻잎찜",
                "꼬막찜",
                "꽈리고추찜",
                "달걀찜_새우젓",
                "달걀찜_우유",
                "닭찜",
                "돼지갈비찜",
                "사태찜_소고기",
                "수육_소고기",
                "순대",
                "아귀찜",
                "애호박찜",
                "옥수수_찐옥수수",
                "족발",
                "코다리찜",
                "콩나물찜_해물",
                "풋고추찜",
                "가자미구이",
                "갈비구이_소고기",
                "갈치구이_기름",
                "고등어구이_석쇠",
                "곱창구이_소고기",
                "김구이_조미김",
                "꼬치구이_닭고기_대파",
                "닭구이",
                "닭발구이",
                "떡갈비",
                "런천미트구이",
                "뱅어포구이",
                "버섯구이",
                "버섯구이_새송이버섯",
                "버섯구이표고버섯",
                "삼겹살구이",
                "삼겹살구이_고추장",
                "삼치구이",
                "새우구이",
                "소불고기",
                "스테이크_소등심",
                "스테이크_소안심",
                "오리고기구이",
                "오리불고기",
                "장어구이_고추장",
                "조개구이_키조개",
                "조기구이",
                "참치구이_머리",
                "치킨데리야끼",
                "함박스테이크",
                "가지전",
                "감자전",
                "고구마전",
                "김치전",
                "달걀말이",
                "달걀부침(달걀후라이)",
                "달걀부침(달걀후라이)_햄",
                "두부부침",
                "맛살전",
                "메밀전",
                "버섯전_표고버섯",
                "부추전",
                "산적_돼지고기",
                "스크램블드에그",
                "애호박전",
                "완자전_돼지고기",
                "완자전_소고기",
                "완자전_참치",
                "완자전_해물",
                "채소전",
                "파전_해물",
                "감자볶음",
                "감자볶음_채소",
                "건새우볶음",
                "곱창볶음_돼지고기",
                "김치볶음",
                "김치볶음_참치",
                "낙지볶음",
                "닭발볶음",
                "닭볶음(닭갈비)",
                "닭볶음(닭갈비)_닭가슴살_피망",
                "당근볶음",
                "돼지고기볶음_김치",
                "돼지고기볶음_채소",
                "돼지고기볶음(제육볶음)",
                "떡볶이",
                "떡볶이_채소",
                "라볶이",
                "마늘쫑볶음",
                "마늘쫑볶음_멸치",
                "마파두부",
                "멸치볶음",
                "멸치볶음_견과류",
                "멸치볶음_꽈리고추",
                "멸치볶음_마늘쫑",
                "멸치볶음_풋고추",
                "문어볶음_고추장",
                "미역줄기볶음",
                "버섯볶음_느타리",
                "버섯볶음_새송이버섯",
                "브로콜리볶음",
                "삼겹살볶음_묵은지김치",
                "새우볶음",
                "소고기볶음_고추장",
                "소고기볶음_버섯",
                "소고기볶음_채소",
                "소시지볶음",
                "애호박 볶음",
                "양파볶음",
                "어묵볶음",
                "어묵볶음_채소",
                "오징어볶음",
                "유산슬",
                "잔멸치볶음_견과류",
                "잔멸치볶음_꽈리고추",
                "잔멸치볶음_풋고추",
                "잔멸치볶음_홍고추_풋고추",
                "잡채",
                "잡채_어묵",
                "잡채_콩나물",
                "죽순볶음_소고기",
                "팔보채",
                "풋고추볶음",
                "햄볶음_채소",
                "감자조림",
                "고등어조림",
                "꽁치조림",
                "닭볶음탕",
                "닭조림",
                "닭조림_고추장",
                "두부조림",
                "땅콩조림",
                "멸치조림",
                "무조림",
                "미트볼조림",
                "버섯조림",
                "병어조림",
                "삼치조림",
                "양미리조림",
                "어묵조림",
                "연근조림",
                "오징어조림",
                "오징어채조림",
                "우엉조림",
                "장조림_달걀",
                "장조림_메추리알",
                "장조림_소고기",
                "장조림_소고기_메추리알",
                "쥐포조림",
                "코다리조림",
                "콩조림(콩자반)",
                "감자튀김",
                "김튀김",
                "다시마튀각",
                "닭다리튀김_간장",
                "닭튀김_날개",
                "떡강정",
                "미역튀각",
                "탕수육_새우",
                "가지나물",
                "고구마줄기나물",
                "고사리나물무침",
                "고춧잎나물무침",
                "깻잎나물",
                "냉이나물",
                "도라지나물무침",
                "머위대나물무침",
                "무나물무침",
                "방풍나물무침",
                "배추나물",
                "비름나물무침",
                "숙주나물",
                "시금치나물",
                "시래기나물무침",
                "씀바귀나물무침",
                "열무나물",
                "열무나물_된장",
                "유채나물",
                "참나물",
                "취나물_된장",
                "취나물_취나물(마른것)",
                "콩나물무침",
                "콩나물무침_고춧가루",
                "토란대나물무침",
                "호박오가리나물무침",
                "가죽나물무침",
                "겉절이_배추",
                "겉절이_상추",
                "겉절이_열무",
                "겉절이_치커리",
                "골뱅이무침_소면",
                "굴무침",
                "김무침",
                "낙지무침",
                "냉채_닭고기",
                "다시마무침",
                "달래무침",
                "도라지생채",
                "두릅무침_초고추장",
                "마늘쫑무침",
                "무말랭이무침",
                "무생채",
                "무생채_굴",
                "묵무침_도토리묵",
                "물회_오징어",
                "미나리무침",
                "미역초무침",
                "민들레잎무침",
                "버섯무침_느타리버섯",
                "부추무침",
                "부추무침_양파",
                "북어채무침",
                "샐러드_감자",
                "샐러드_단호박",
                "샐러드_닭가슴살",
                "샐러드_새싹",
                "샐러드_양배추",
                "샐러드_양상추",
                "샐러드_옥수수",
                "샐러드_참치",
                "샐러드_채소",
                "양장피",
                "오이무침_부추",
                "오이생채",
                "오이지무침",
                "오징어무침_채소",
                "오징어채무침",
                "톳나물무침",
                "파래무침",
                "파무침",
                "풋고추된장무침_풋고추",
                "풋마늘무침",
                "피조개무침",
                "해초무침",
                "회무침",
                "회무침_가오리",
                "돌나물무침",
                "고들빼기김치",
                "깍두기",
                "깻잎김치",
                "나박김치",
                "동치미",
                "물김치_돌나물",
                "보쌈김치",
                "부추김치",
                "얼갈이배추김치",
                "오이김치",
                "가자미식해",
                "갈치젓_양념",
                "멸치젓_양념",
                "새우젓_양념",
                "오징어젓_양념",
                "꽃게장_간장",
                "꽃게장_양념",
                "단무지",
                "더덕장아찌",
                "매실장아찌_우메보시(일본)",
                "무짠지",
                "무초절임(치킨무)",
                "오이장아찌",
                "오이지",
                "미숫가루",
                "육회",
                "리소토/리조또_스파이시 씨푸드 리조또",
                "리소토/리조또_치킨 크림 리조또",
                "볶음밥_갈비천왕 치즈 치밥",
                "볶음밥_달걀듬뿍 볶음밥",
                "볶음밥_닭갈비 볶음밥",
                "볶음밥_볼케이노 치즈 치밥",
                "볶음밥_의성마늘 볶음밥",
                "오므라이스_수플레 오믈렛 라이스",
                "주먹밥_까르보나라 구운주먹밥",
                "주먹밥_매콤 로제 구운주먹밥",
                "감자빵_강원도알감자빵 (5개입)",
                "감자빵_강원도알감자빵",
                "감자빵_감자쫀득볼",
                "감자빵_못난이 감자크럼볼",
                "감자빵_포슬쫀득 감자빵",
                "건포도빵_건포도빵 (대)",
                "건포도빵_건포도빵 (소)",
                "건포도빵_우리쌀건포도브레드",
                "계란빵_쌀계란빵",
                "계란빵_트윈에그 브레드",
                "기타빵_밤이랑고구마랑",
                "기타빵_별님고구마",
                "기타빵_춘천 감자빵",
                "기타빵_까눌레",
                "기타빵_달콤촉촉 고구마빵",
                "기타빵_롤링넛츠",
                "기타빵_씨앗가득고소함이찰떡",
                "기타빵_얼그레이 까눌레",
                "기타빵_오리지널 까눌레",
                "기타빵_우리쌀 막걸리로 만든 초당옥수수빵",
                "기타빵_카라멜아몬드",
                "기타빵_톡톡쫄깃 옥수수빵",
                "깨찰빵_깨찰빵",
                "깨찰빵_깨찰빵",
                "깨찰빵_씨앗찰빵",
                "깨찰빵_쫀득쫀득한찰깨빵 (2개입)",
                "깨찰빵_쫀득쫀득한찰깨빵",
                "깨찰빵_쫀득한모카찰깨빵",
                "도넛_고구마품은 꽈배기",
                "도넛_골드초코 허니비 도넛",
                "도넛_글레이즈드 사워크림 도넛",
                "도넛_글레이즈드 초콜릿 케익 도넛",
                "도넛_글레이즈츄잉스타",
                "도넛_기라델리민트초코링 도넛",
                "도넛_깨찰 도넛",
                "도넛_깨찰 도넛",
                "도넛_뉴욕 치즈케익 도넛",
                "도넛_뉴패스트리 도넛",
                "도넛_다크초코링도넛",
                "도넛_다크초코츄잉스타",
                "도넛_단팥도너츠",
                "도넛_단팥품은 꽈배기",
                "도넛_달콤한 꿀도넛",
                "도넛_달콤한꿀도넛 (3개입)",
                "도넛_달콤한꿀도넛 (4개입)",
                "도넛_달콤한꿀도넛 (5개입)",
                "도넛_달콤한 왕꽈배기",
                "도넛_던킨카페모카롤",
                "도넛_데니쉬 꽈배기",
                "도넛_돌돌말린소시지 도넛",
                "도넛_딸기 와플넛",
                "도넛_딸기 우유크림 듬뿍 도넛",
                "도넛_딸기마카롱 도넛",
                "도넛_딸기츄이스티 도넛",
                "도넛_또르체티 이탈리아 꽈배기과자",
                "도넛_러블리듀얼하트 도넛",
                "도넛_레이디버그 도넛",
                "도넛_로투스 비스코프 도넛",
                "도넛_루비초코 블라썸 도넛",
                "도넛_못난이찹쌀고구마크림치즈 도넛",
                "도넛_못난이찹쌀깨찰 도넛",
                "도넛_못난이찹쌀 꽈배기",
                "도넛_못난이찹쌀모짜렐라치즈 도넛",
                "도넛_못난이찹쌀유자 도넛",
                "도넛_못난이찹쌀팥 도넛",
                "도넛_미니 오리지널 글레이즈드 도넛",
                "도넛_미니찹쌀도너츠",
                "도넛_미니찹쌀 도넛 (3개입)",
                "도넛_미니찹쌀 도넛 (4개입)",
                "도넛_미니찹쌀 도넛 (5개입)",
                "도넛_미니찹쌀 도넛",
                "도넛_미니찹쌀 도넛",
                "도넛_밀크크림 플라워 도넛",
                "도넛_베리베리크림 도넛",
                "도넛_베이크드 헤이즐넛 쇼콜라넛",
                "도넛_보스톤크림 도넛",
                "도넛_생도넛",
                "도넛_생도넛",
                "도넛_소금우유 도넛",
                "도넛_소보로만난 앙넛",
                "도넛_솔티카라멜바이츠 도넛",
                "도넛_송사부 꽈배기",
                "도넛_슈거코티드 도넛",
                "도넛_스노우링 도넛",
                "도넛_시나몬슈가링 도넛",
                "도넛_아몬드초코링 도넛",
                "도넛_엄마랑장볼때먹던그때그도나쓰",
                "도넛_오리지널 글레이즈드 도넛",
                "도넛_오리지널 바이츠 도넛",
                "도넛_오리지널 우유 크림 필드 도넛",
                "도넛_오리지널 초콜릿 필드 도넛",
                "도넛_옥수수꽈배기 도넛",
                "도넛_옥수수찹쌀 도넛",
                "도넛_올드훼션드먼치킨",
                "도넛_올리브츄이스티 도넛",
                "도넛_왕크림 도넛",
                "도넛_요거트올드훼션드 도넛",
                "도넛_우유크림 듬뿍 도넛",
                "도넛_쫄깃한 왕꽈배기",
                "도넛_쫄깃한찹쌀 도넛",
                "도넛_쫄깃한찹쌀스틱 시나몬",
                "도넛_찹쌀꽈배기도너츠",
                "도넛_찹쌀 꽈배기",
                "도넛_찹쌀도너츠",
                "도넛_찹쌀 도넛",
                "도넛_찹쌀 도넛",
                "도넛_찹쌀페스츄리 도넛",
                "고구마맛탕",
                "고구마튀김",
                "고추튀김",
                "김말이튀김",
                "다시마튀각",
                "닭튀김",
                "닭튀김_양념",
                "돈가스",
                "미역튀각",
                "북어강정",
                "생선까스",
                "탕수육",
                "새우튀김",
                "오징어튀김",
                "가자미튀김",
                "가지탕수",
                "갈치튀김",
                "감자연근튀김",
                "게맛살튀김",
                "고등어튀김",
                "김부각",
                "깐풍기",
                "꽁치튀김",
                "난자완스",
                "느타리버섯튀김",
                "닭강정",
                "닭고기 탕수",
                "동태튀김",
                "돼지고기강정",
                "두부튀김",
                "삼치튀김",
                "새우 탕수",
                "소시지튀김",
                "쑥튀김",
                "양념 돼지고기튀김",
                "어묵튀김",
                "연근튀김",
                "오징어탕수",
                "임연수튀김",
                "조기튀김",
                "참치강정",
                "채소튀김",
                "탕수어",
                "가지나물",
                "고구마줄기나물",
                "고구마줄기나물_고춧가루",
                "고구마줄기나물_들깨",
                "깻잎나물",
                "미나리나물_고추장",
                "미나리나물_소금",
                "미나리나물_팽이버섯",
                "배추나물",
                "배추나물_간장_소금",
                "배추나물_된장",
                "숙주나물",
                "숙주나물_숙주",
                "숙주나물_숙주_채소",
                "숙주나물_미나리",
                "숙주미나리나물",
                "시금치나물",
                "시금치나물_간장_소금",
                "시금치나물_당근",
                "시금치나물_소금",
                "시래기나물",
                "열무나물_간장",
                "열무나물_된장",
                "유채나물",
                "유채나물_간장_소금",
                "참나물",
                "취나물_간장_소금",
                "취나물_된장",
                "취나물무침_간장",
                "취나물무침_소금",
                "콩나물무침_고추",
                "콩나물무침_당근",
                "콩나물무침_당근_시금치",
                "콩나물무침_부추",
                "콩나물무침_소금",
                "콩나물무침_시금치",
                "고사리나물",
                "고춧잎나물",
                "근대나물",
                "냉이초나물",
                "도라지나물",
                "머위나물_소금",
                "모듬배추나물_된장",
                "무나물",
                "방풍나물_고추장",
                "부추나물",
                "비름나물",
                "비름나물_간장",
                "비름나물_고추장",
                "비름나물_된장",
                "쑥갓나물",
                "쑥갓나물_두부",
                "쑥갓나물_소금",
                "애호박나물",
                "양배추 초나물",
                "얼갈이 나물",
                "오이나물",
                "호박나물",
                "골뱅이무침_채소",
                "과일샐러드",
                "낙지무침",
                "노각무침",
                "다시마무침",
                "단무지무침",
                "달래무침",
                "달래무침_오이",
                "도라지생채",
                "도라지생채_오이",
                "도라지생채_북어",
                "도토리묵무침",
                "도토리묵무침_채소",
                "돌나물",
                "마늘쫑무침",
                "무말랭이무침",
                "무생채",
                "무생채_굴",
                "무생채_식초",
                "무생채_미나리",
                "무생채(무만)",
                "미나리무침",
                "미나리무침_고추장",
                "미역초무침",
                "배추 겉절이",
                "부추무침",
                "부추무침_부추",
                "부추무침_부추_채소",
                "부추무침_양파",
                "부추무침_채소",
                "상추 겉절이",
                "상추 겉절이",
                "샐러드_마카로니",
                "샐러드_옥수수",
                "양장피",
                "얼갈이 겉절이",
                "오이무침",
                "오이생채_부추",
                "오이생채_양파",
                "오이생채_오이",
                "오이생채_오이_부추",
                "오이생채_고추장",
                "오이지무침",
                "오징어무침",
                "오징어무침_채소",
                "오징어채무침",
                "오징어채무침_채소",
                "참나물 겉절이",
                "참나물 겉절이_고춧가루",
                "참나물 겉절이_간장",
                "청포묵 무침",
                "청포묵 무침",
                "치커리 겉절이",
                "치커리 겉절이",
                "탕평채",
                "파래무침",
                "파래무침_파래_무",
                "파무침",
                "풋고추된장무침",
                "풋마늘무침",
                "가오리회무침",
                "감자샐러드",
                "감자샐러드_오이",
                "겨자채",
                "고추장아찌 무침",
                "달걀 샐러드",
                "닭가슴살 샐러드_드레싱",
                "닭고기 샐러드",
                "닭고기냉채",
                "닭튀김 샐러드",
                "돌나물무침",
                "두부냉채",
                "마늘쫑장아찌무침",
                "마카로니 샐러드",
                "메밀묵 무침",
                "멕시컨샐러드",
                "무 파래무침",
                "미나리 초무침",
                "미역 오이무침",
                "부추 겉절이",
                "북어채 고추장 무침",
                "브로콜리 두부무침",
                "브로콜리무침",
                "삼색냉채",
                "새싹 샐러드",
                "새우무침",
                "소라무침",
                "시금치 겉절이",
                "쑥갓오이무침",
                "양배추 겉절이",
                "양배추 사과 샐러드",
                "양배추 샐러드",
                "양배추부추무침",
                "양상추 샐러드",
                "어묵 오이무침",
                "오이 도라지 생채",
                "오이고추 된장무침",
                "옥수수샐러드",
                "옥수수샐러드_햄",
                "유채무침",
                "쥐포무침",
                "짜사이무침",
                "참나물 무침_된장",
                "참치 샐러드",
                "천사채무침",
                "콩나물 느타리무침",
                "콩나물냉채_오이",
                "해파리냉채",
                "햄샐러드",
                "홍어회무침",
                "깻잎김치",
                "부추김치",
                "오이김치",
                "오이소박이",
                "꽃게장_양념",
                "양념 오징어젓",
                "오이장아찌",
                "깻잎장아찌",
                "짜장소스",
                "카레소스",
                "고춧가루 양념장",
                "초간장",
                "팥빙수",
                "딸기바나나 스무디",
                "미숫가루(선식)음료",
                "수박화채",
                "율무차",
                "감자범벅",
                "참치찌개",
                "김치찜_돼지고기",
                "김치찜_돼지고기_두부",
                "깻잎찜",
                "꼬막찜",
                "꽈리고추찜",
                "달걀찜",
                "달걀찜_당근",
                "닭찜",
                "닭찜_간장",
                "닭찜_매운양념",
                "대구찜",
                "동태찜",
                "돼지갈비찜",
                "돼지갈비찜_채소",
                "소갈비찜",
                "순대",
                "아귀찜",
                "애호박찜",
                "조기찜",
                "코다리찜",
                "해물콩나물찜",
                "가자미찜",
                "고등어찜",
                "돼지사태찜",
                "두부 달걀찜",
                "망둥어찜",
                "바지락찜",
                "소고기찜",
                "소사태찜",
                "연두부찜",
                "제육(돼지고기 수육)",
                "가자미구이",
                "갈치구이",
                "갈치구이_기름",
                "감자구이",
                "고등어구이",
                "고등어구이_기름",
                "고등어구이_카레",
                "굴비구이",
                "꽁치구이",
                "닭구이",
                "닭날개구이",
                "닭다리구이",
                "돼지갈비구이",
                "돼지불고기_간장",
                "돼지불고기_고추장",
                "런천미트구이",
                "삼치구이",
                "소불고기",
                "연어구이",
                "오리고기로스",
                "임연수구이",
                "조기구이",
                "참치구이",
                "치킨데리야끼",
                "콘치즈구이",
                "함박스테이크",
                "넙치구이",
                "돼지고기 꼬치구이",
                "돼지고기 스테이크",
                "베이컨떡말이구이",
                "북어구이",
                "삼치 양념구이",
                "소갈비 구이",
                "소등심 스테이크",
                "소등심구이",
                "오리 간장불고기",
                "오징어불고기",
                "우럭구이",
                "장어 양념구이",
                "적어구이",
                "조기 양념구이",
                "조기 오븐구이",
                "조미 김구이",
                "햄구이",
                "가지전",
                "감자전",
                "굴전",
                "김치전",
                "깻잎전",
                "녹두빈대떡",
                "달걀말이",
                "달걀말이_채소",
                "달걀말이_부추",
                "달걀부침(달걀후라이)",
                "동태전",
                "두부부침",
                "두부전",
                "맛살전",
                "배추전",
                "버섯전",
                "부추전",
                "새우전",
                "스크램블드에그",
                "애호박전",
                "완자전",
                "채소전",
                "파전",
                "파전_감자_김치",
                "해물파전",
                "햄부침",
                "달걀후라이",
                "떡산적_소고기",
                "소고기 완자전",
                "애호박부침개_새우",
                "연근전",
                "옥수수부침",
                "해물 완자전",
                "감자볶음",
                "감자볶음_감자_당근",
                "감자볶음_풋고추",
                "감자볶음_당근",
                "감자볶음_양파",
                "감자볶음_햄",
                "감자볶음_햄_채소",
                "건새우볶음",
                "고추잡채",
                "고추장볶음",
                "김치볶음",
                "김치볶음_김치_참치",
                "김치볶음_돼지고기",
                "김치볶음_참치",
                "김치볶음_햄",
                "낙지볶음",
                "낙지볶음_떡",
                "느타리버섯볶음_느타리버섯_채소",
                "닭볶음(닭갈비)",
                "닭볶음(닭갈비)_매운양념",
                "돼지고기볶음_김치",
                "돼지고기볶음_돼지고기_배추김치",
                "돼지고기볶음_돼지고기_오징어",
                "돼지고기볶음_돼지고기_채소",
                "돼지고기볶음_짜장",
                "두부김치",
                "떡볶이_간장",
                "떡볶이_고추장_어묵",
                "떡볶이_소고기",
                "떡볶이_어묵",
                "떡볶이_양배추",
                "라볶이",
                "마늘쫑볶음_간장",
                "마늘쫑볶음_건새우",
                "마늘쫑볶음_잔멸치",
                "마늘쫑볶음_건어물",
                "마파두부",
                "멸치볶음",
                "멸치볶음_견과류",
                "미역줄기볶음",
                "미역줄기볶음_미역줄기",
                "삼겹살볶음_세발낙지",
                "새송이버섯볶음_새송이버섯_채소",
                "소고기볶음",
                "소고기볶음_버섯",
                "소시지볶음",
                "소시지볶음_채소",
                "순대볶음",
                "순대볶음_떡",
                "순대볶음_채소",
                "양파볶음",
                "어묵볶음",
                "어묵볶음_어묵_채소",
                "어묵볶음_채소",
                "오징어볶음",
                "오징어볶음_채소",
                "오징어채볶음",
                "잔멸치볶음_간장",
                "잔멸치볶음_간장_고추장",
                "잔멸치볶음_견과류",
                "잔멸치볶음_꽈리고추",
                "잔멸치볶음_풋고추",
                "잡채_돼지고기",
                "잡채_버섯",
                "죽순볶음",
                "파래볶음",
                "팔보채",
                "표고버섯볶음",
                "해물볶음",
                "햄채소볶음",
                "김치 돼지고기볶음",
                "껍질콩볶음_맛살",
                "꽈리고추볶음",
                "꽈리고추볶음_잔멸치",
                "꽈리고추볶음_잔멸치_호두",
                "두부볶음_돼지고기",
                "매운 어묵볶음",
                "모듬버섯볶음",
                "베이컨채소볶음",
                "부추잡채",
                "브로콜리 버섯볶음",
                "세발낙지볶음",
                "소고기채소볶음",
                "소시지 케첩볶음",
                "양송이버섯볶음_소고기",
                "어묵 감자볶음",
                "어묵잡채",
                "우엉볶음",
                "제육볶음",
                "제육볶음_채소",
                "제육볶음_오징어",
                "콩나물잡채",
                "가자미조림",
                "갈치조림_무",
                "감자조림",
                "고등어조림_무",
                "고등어조림_배추김치",
                "고추조림",
                "고추조림_멸치",
                "꽁치조림_무",
                "꽁치조림_배추김치",
                "꽁치조림_채소",
                "달걀조림",
                "닭도리탕",
                "닭조림",
                "동태조림",
                "두부조림",
                "땅콩조림",
                "멸치조림",
                "무조림",
                "미트볼조림",
                "병어조림",
                "삼치조림",
                "양미리조림",
                "어묵조림",
                "어묵조림_풋고추",
                "연근조림",
                "오징어조림",
                "우엉조림",
                "장조림_돼지고기_메추리알",
                "쥐포조림",
                "코다리조림",
                "코다리조림_무",
                "코다리조림_간장",
                "게조림",
                "곤약조림",
                "단호박조림",
                "닭다리조림",
                "도루묵조림",
                "돼지고기 장조림",
                "돼지등심 장조림",
                "메추리알 돼지고기장조림",
                "메추리알 어묵조림",
                "메추리알장조림",
                "무 어묵조림",
                "삶은 땅콩 조림",
                "소고기 장조림",
                "소고기 장조림_메추리알",
                "소고기 장조림_꽈리고추",
                "소시지조림",
                "소시지조림_어묵",
                "완자조림",
                "유부조림",
                "임연수조림",
                "콩조림",
                "감자튀김",
                "모듬 초밥",
                "소고기 국밥_내장",
                "소고기 덮밥",
                "열무 비빔밥",
                "오징어 덮밥",
                "오징어 덮밥_채소",
                "옥수수밥",
                "완두콩밥",
                "유부 초밥",
                "채소밥",
                "팥밥",
                "혼합잡곡밥",
                "계란빵",
                "피자",
                "햄버거",
                "햄버거_돼지고기",
                "햄버거_치킨",
                "호떡",
                "감자샐러드 샌드위치",
                "소고기 샌드위치",
                "햄샌드위치",
                "국수",
                "국수_열무김치",
                "떡국_굴",
                "떡국_달걀",
                "떡국_소고기",
                "떡국_소고기_달걀",
                "떡만두국",
                "떡만두국_고기만두",
                "떡만두국_김치만두",
                "라면",
                "라면_달걀",
                "라면_어묵",
                "만두국_고기만두",
                "만두국_김치만두",
                "수제비_김치",
                "스파게티",
                "스파게티_미트소스",
                "스파게티_토마토소스",
                "쌀국수",
                "우동",
                "자장면",
                "잔치국수",
                "짬뽕",
                "쫄면",
                "칼국수",
                "칼국수_닭고기",
                "칼국수_바지락",
                "칼국수_소고기",
                "칼국수_해물",
                "콩국수",
                "고기만두",
                "군만두",
                "김치 고기만두",
                "김치만두",
                "나폴리탄 스파게티",
                "막국수",
                "만두탕수",
                "모밀국수",
                "물냉면",
                "물냉면_열무",
                "물만두",
                "미트 스파게티",
                "바지락 수제비_감자",
                "볶음 우동",
                "비빔냉면",
                "어묵 우동",
                "장국국수",
                "짜장면",
                "해물 스파게티",
                "닭죽",
                "닭죽_채소",
                "전복죽",
                "참치죽",
                "채소죽",
                "채소죽_달걀",
                "팥죽",
                "호박죽",
                "감자스프",
                "대합죽",
                "들깨죽",
                "땅콩죽",
                "잡곡죽",
                "홍합 소고기죽",
                "흰죽",
                "갈비탕",
                "감자국",
                "감자국_소고기",
                "곰탕",
                "굴국_두부",
                "김치국",
                "김치국_김치",
                "김치국_김치_두부",
                "김치국_콩나물",
                "달걀국",
                "닭고기육개장",
                "닭곰탕",
                "닭백숙",
                "된장국_근대",
                "된장국_두부",
                "된장국_배추",
                "된장국_시금치",
                "된장국_시래기",
                "된장국_아욱",
                "된장국_얼갈이배추",
                "된장국_유부",
                "들깨국",
                "무국",
                "무국_들깨",
                "무국_소고기",
                "무국_소고기_콩나물",
                "무국_어묵",
                "미소된장국",
                "미역국",
                "미역국_북어",
                "미역국_소고기",
                "미역국_홍합",
                "미역냉국",
                "미역냉국_오이",
                "미역냉국_오이_고추",
                "배추국",
                "북어국_무",
                "북어국_무_두부",
                "북어국_콩나물",
                "북어국_달걀",
                "사골국",
                "삼계탕",
                "새우탕",
                "설렁탕",
                "소고기육개장",
                "순대국",
                "어묵국(어묵탕)_고춧가루 제외",
                "오이냉국",
                "오징어국",
                "육개장_닭고기",
                "육개장_소고기",
                "육개장_돼지고기",
                "재첩국",
                "콩나물국_고춧가루",
                "콩나물국_콩나물만",
                "콩나물국_고추",
                "콩나물국_청양고추",
                "토란국",
                "가지냉국",
                "감자 된장국",
                "감자 호박된장국",
                "건새우 미역국",
                "고디국(다슬기맑은국)",
                "굴 미역국",
                "근대 된장국",
                "김치 된장국",
                "김치 콩나물국",
                "꼬리곰탕",
                "동태국",
                "냉이 된장국",
                "닭고기 미역국",
                "대합 미역국",
                "두부 된장국",
                "두부 된장국_유부",
                "두부국",
                "메밀묵국",
                "멸치 미역국",
                "무 된장국",
                "무 북어국",
                "바지락 미역국",
                "바지락국",
                "배추 된장국",
                "배추 된장국_소고기",
                "버섯국",
                "뼈다귀해장국",
                "삼색 오이냉국",
                "새우젓국",
                "선짓국",
                "소고기 두부국",
                "소고기 미역국",
                "시금치 된장국",
                "시래기 된장국",
                "아욱 된장국",
                "애호박 감자된장국_바지락",
                "애호박 된장국",
                "어묵국",
                "어묵탕",
                "어묵탕_고춧가루",
                "얼갈이 된장국",
                "열무 된장국",
                "오이 미역냉국",
                "올갱이해장국",
                "유부 된장국_무",
                "조개 미역국",
                "참치 미역국",
                "콩나물 된장국",
                "콩나물 선짓국_낙지",
                "콩나물 황태국",
                "해물 된장국",
                "호박 된장국",
                "홍합 무국",
                "홍합 미역국",
                "홍합국(홍합탕)",
                "갈치찌개",
                "감자탕",
                "고등어찌개",
                "김치찌개",
                "김치찌개_꽁치",
                "김치찌개_돼지고기",
                "김치찌개_돼지고기_두부",
                "김치찌개_어묵",
                "김치찌개_참치",
                "김치찌개_햄",
                "김치찌개_삼겹살",
                "꽃게탕",
                "동태찌개",
                "돼지고기찌개",
                "된장찌개_바지락",
                "된장찌개_소고기",
                "된장찌개_우렁",
                "된장찌개_모듬채소",
                "된장찌개_미더덕",
                "된장찌개_콩나물",
                "된장찌개_호박",
                "두부찌개_바지락",
                "두부찌개_새우젓",
                "두부찌개_소고기",
                "버섯찌개",
                "부대찌개",
                "불낙전골",
                "오리백숙",
                "오리탕",
                "오징어찌개",
                "청국장찌개_배추김치",
                "추어탕",
                "콩비지찌개",
                "가자미 매운탕",
                "광어 매운탕",
                "김치 청국장찌개",
                "김치순두부",
                "김치순두부_돼지고기",
                "김치순두부_해물",
                "대구 매운탕",
                "대구지리",
                "동태 매운탕",
                "두부 청국장찌개",
                "두부 청국장찌개_김치",
                "버섯 매운탕",
                "섞어찌개(모듬찌개)",
                "아귀 매운탕",
                "애호박찌개_감자",
                "어묵 매운탕",
                "장어매운탕",
                "조기찌개",
                "녹두전",
                "달걀후라이",
                "떡산적_소고기",
                "소고기 완자전",
                "애호박부침개",
                "오믈렛",
                "해물 완자전",
                "감자볶음",
                "감자볶음_감자_베이컨",
                "감자볶음_감자_햄",
                "감자볶음_잔멸치",
                "감자볶음_채소",
                "감자볶음_양파",
                "감자볶음_햄_채소",
                "건새우볶음",
                "고추잡채",
                "고추장볶음",
                "김치볶음",
                "김치볶음_김치",
                "김치볶음_김치_참치",
                "김치볶음_돼지고기",
                "김치볶음_참치",
                "김치볶음_햄",
                "낙지볶음",
                "느타리버섯볶음",
                "느타리버섯볶음_느타리버섯_채소",
                "닭볶음(닭갈비)",
                "닭볶음(닭갈비)_매운양념",
                "닭볶음(닭갈비)_매운양념_치즈",
                "돼지고기볶음_김치",
                "돼지고기볶음_돼지고기_배추김치",
                "돼지고기볶음_돼지고기_버섯",
                "돼지고기볶음_돼지고기_오징어",
                "돼지고기볶음_돼지고기_짜장",
                "돼지고기볶음_돼지고기_채소",
                "돼지고기볶음_짜장",
                "떡볶이",
                "떡볶이_간장",
                "떡볶이_고추장_메추리알",
                "떡볶이_고추장_어묵",
                "떡볶이_소고기",
                "떡볶이_어묵",
                "떡볶이_모듬",
                "마파두부",
                "멸치볶음_견과류",
                "미역줄기볶음",
                "미역줄기볶음_미역줄기_채소",
                "소고기볶음_고추장",
                "소시지볶음",
                "소시지볶음_채소",
                "순대볶음",
                "순대볶음_채소",
                "어묵볶음",
                "어묵볶음_어묵_채소",
                "어묵볶음_채소",
                "오징어볶음",
                "오징어볶음_채소",
                "오징어채볶음",
                "잔멸치볶음",
                "잔멸치볶음_간장_고추장",
                "잔멸치볶음_견과류",
                "잔멸치볶음_고추장",
                "잔멸치볶음_잔멸치_견과류",
                "잔멸치볶음_풋고추",
                "잡채_돼지고기",
                "잡채_버섯_소고기",
                "잡채_소고기",
                "주꾸미볶음",
                "파래볶음",
                "표고버섯볶음",
                "햄채소볶음",
                "꽈리고추볶음_잔멸치",
                "꽈리고추볶음_잔멸치_호두",
                "돼지고기 피망잡채",
                "매운 어묵볶음",
                "모듬버섯볶음",
                "부추잡채",
                "브로콜리 버섯볶음",
                "세발낙지볶음",
                "소고기채소볶음",
                "소시지 케첩볶음",
                "양송이버섯볶음_소고기",
                "어묵잡채",
                "우엉볶음",
                "제육볶음",
                "제육볶음_채소",
                "제육볶음_오징어",
                "콩나물잡채",
                "폭찹",
                "가자미조림",
                "갈치조림_무",
                "감자조림",
                "고등어조림",
                "고등어조림_무",
                "고등어조림_배추김치",
                "꽁치조림",
                "꽁치조림_무",
                "꽁치조림_배추김치",
                "달걀조림",
                "닭도리탕",
                "닭조림",
                "두부조림",
                "두부조림_돼지고기",
                "멸치조림",
                "무조림",
                "미트볼조림",
                "삼치조림",
                "어묵조림",
                "연근조림",
                "우엉조림",
                "장조림_돼지고기_메추리알",
                "쥐포조림",
                "코다리조림_무",
                "고구마조림",
                "곤약조림",
                "다시마조림",
                "돼지고기 장조림",
                "돼지등심 장조림",
                "메추리알 돼지고기장조림",
                "메추리알장조림",
                "무 어묵조림",
                "삶은 땅콩 조림",
                "소고기 장조림",
                "소고기 장조림_메추리알",
                "소시지조림",
                "오징어포조림",
                "완자조림",
                "콩조림",
                "감자튀김",
                "고구마맛탕",
                "고구마튀김",
                "고추튀김",
                "김말이튀김",
                "닭튀김",
                "닭튀김_양념",
                "떡강정",
                "북어강정",
                "생선까스",
                "탕수육",
                "새우튀김",
                "오징어튀김",
                "가자미튀김",
                "가지탕수",
                "깐풍기",
                "깻잎튀김",
                "닭강정",
                "돼지갈비강정",
                "돼지고기강정",
                "두부 탕수",
                "두부튀김",
                "등심돈가스",
                "삼치튀김",
                "새우 탕수",
                "소시지튀김",
                "식빵튀김",
                "어묵튀김",
                "오징어탕수",
                "임연수튀김",
                "장어튀김",
                "채소튀김",
                "탕수어",
                "가지나물",
                "고구마줄기나물",
                "고구마줄기나물_고춧가루",
                "깻잎나물",
                "배추나물",
                "숙주나물",
                "숙주나물_숙주",
                "숙주나물_숙주_게맛살",
                "숙주나물_미나리",
                "숙주미나리나물",
                "시금치나물",
                "시금치나물_간장",
                "시금치나물_간장_소금",
                "시래기나물",
                "열무나물_간장",
                "열무나물_된장",
                "유채나물",
                "참나물",
                "취나물_된장",
                "취나물무침",
                "취나물무침_간장",
                "취나물무침_소금",
                "콩나물무침",
                "콩나물무침_고춧가루",
                "콩나물무침_콩나물_고춧가루",
                "콩나물무침_콩나물_고춧가루제외",
                "콩나물무침_당근",
                "콩나물무침_당근_시금치",
                "콩나물무침_부추",
                "콩나물무침_소금",
                "콩나물무침_시금치",
                "고사리나물",
                "고춧잎나물",
                "근대나물",
                "도라지나물",
                "모듬배추나물_된장",
                "무나물",
                "배추숙주나물",
                "비름나물_소금",
                "쑥갓나물",
                "쑥갓나물_고춧가루",
                "쑥갓나물_두부",
                "양배추나물",
                "호박나물",
                "골뱅이무침",
                "골뱅이무침_채소",
                "과일샐러드",
                "노각무침",
                "단무지무침",
                "달래무침",
                "더덕무침",
                "도라지생채",
                "도라지생채_오이",
                "도토리묵무침",
                "도토리묵무침_채소",
                "돌나물",
                "무말랭이무침",
                "무말랭이무침_오징어",
                "무생채",
                "무생채_식초",
                "무생채_미역",
                "무생채_액젓",
                "배추 겉절이",
                "부추무침",
                "부추무침_부추_채소",
                "부추무침_양파",
                "상추 겉절이",
                "샐러드_감자",
                "얼갈이 겉절이",
                "오이무침_양파",
                "오이무침_달래",
                "오이생채_부추",
                "오이생채_오이",
                "오이생채_오이_달래",
                "오이생채_오이_부추",
                "오이지무침",
                "오징어무침",
                "오징어무침_채소",
                "오징어무침_미나리",
                "오징어채무침",
                "참나물 겉절이",
                "참나물 겉절이_단감",
                "청포묵 무침",
                "치커리 겉절이",
                "탕평채",
                "파래무침_무",
                "파무침",
                "감자샐러드",
                "겨자채",
                "달걀 샐러드",
                "닭고기 샐러드",
                "닭고기냉채",
                "닭튀김 샐러드",
                "두부냉채",
                "마늘쫑장아찌무침",
                "마카로니 샐러드",
                "미나리 초무침",
                "부추 초무침",
                "브로콜리 두부무침",
                "양배추 겉절이",
                "양배추 사과 샐러드",
                "양배추부추무침",
                "양배추오이 샐러드",
                "양상추 샐러드",
                "어묵 오이무침",
                "오이 도라지 생채",
                "오이고추 된장무침",
                "오이모듬무침",
                "옥수수샐러드",
                "유채무침",
                "쥐포무침",
                "참치 샐러드",
                "천사채무침",
                "콩나물 느타리무침",
                "콩나물냉채_오이",
                "햄샐러드",
                "보쌈김치",
                "부추김치",
                "오이김치",
                "섞박지",
                "양배추김치",
                "양파장아찌",
                "짜장소스",
                "카레소스",
                "고춧가루 양념장",
                "양념초장",
                "초간장",
                "미숫가루(선식)음료",
                "수박화채",
                "감자범벅",
                "곤드레밥",
                "기장밥",
                "기장밥_찹쌀",
                "김밥",
                "김밥_소고기",
                "김밥_참치",
                "김밥_채소",
                "돌솥 비빔밥",
                "묵밥",
                "보리밥",
                "볶음밥_계란",
                "볶음밥_김치_돼지고기",
                "볶음밥_새우",
                "볶음밥_참치_김치",
                "볶음밥_채소",
                "볶음밥_해물",
                "볶음밥_햄",
                "비빔밥",
                "비빔밥_열무_양념장",
                "비빔밥_참치",
                "비빔밥_참치_양념장",
                "삼각김밥",
                "수수밥",
                "알밥",
                "영양돌솥밥",
                "오곡밥",
                "오므라이스",
                "율무밥",
                "잡곡밥",
                "잡곡밥_보리",
                "잡곡밥_보리_흑미",
                "잡곡밥_서리태",
                "잡곡밥_현미",
                "잡채밥",
                "주먹밥",
                "짜장밥",
                "짬뽕밥",
                "차조밥",
                "카레라이스_돼지고기",
                "카레라이스_돼지고기_모듬채소",
                "콩나물 국밥",
                "콩나물밥_소고기",
                "콩나물밥_양념장",
                "하이라이스",
                "현미밥",
                "현미밥_쌀",
                "회덮밥_참치",
                "흑미밥",
                "감자밥",
                "강낭콩밥",
                "검정콩밥",
                "고구마밥",
                "낙지 덮밥",
                "낙지 비빔밥",
                "닭고기 덮밥",
                "돼지머리국밥",
                "연근튀김",
                "연어튀김",
                "오징어탕수",
                "임연수튀김",
                "장어튀김",
                "참치강정",
                "채소튀김",
                "가지나물",
                "고구마줄기나물",
                "고구마줄기나물_고춧가루",
                "고구마줄기나물_들깨",
                "깻잎나물",
                "깻잎나물_깻잎",
                "미나리나물_고추장",
                "배추나물",
                "배추나물_된장",
                "숙주나물",
                "숙주나물_숙주",
                "숙주나물_숙주_채소",
                "숙주나물_미나리",
                "숙주미나리나물",
                "시금치나물",
                "시금치나물_간장",
                "시금치나물_간장_소금",
                "시금치나물_고추장",
                "시래기나물",
                "열무나물_간장",
                "열무나물_된장",
                "유채나물",
                "참나물",
                "취나물_간장_소금",
                "취나물_된장",
                "취나물무침",
                "취나물무침_간장",
                "콩나물무침_고춧가루",
                "콩나물무침_콩나물_고춧가루",
                "콩나물무침_고추",
                "콩나물무침_당근",
                "콩나물무침_당근_시금치",
                "콩나물무침_부추",
                "콩나물무침_소금",
                "콩나물무침_시금치",
                "톳나물_두부",
                "고사리나물",
                "고춧잎나물",
                "근대나물",
                "도라지나물",
                "머위나물_소금",
                "모듬배추나물_된장",
                "무나물",
                "부추나물",
                "비름나물",
                "비름나물_간장",
                "비름나물_된장",
                "비름나물_소금",
                "쑥갓나물",
                "쑥갓나물_고춧가루",
                "쑥갓나물_두부",
                "애호박나물",
                "양배추나물",
                "오이나물",
                "갑오징어무침",
                "골뱅이무침",
                "골뱅이무침_채소",
                "골뱅이무침_채소_소면",
                "과일샐러드",
                "노각무침",
                "다시마무침",
                "단무지무침",
                "더덕무침",
                "도라지생채",
                "도라지생채_오이",
                "도라지생채_오징어채",
                "도토리묵무침",
                "도토리묵무침_채소",
                "마늘쫑무침",
                "무말랭이무침",
                "무생채",
                "무생채_식초",
                "무생채_액젓",
                "미나리무침_고추장",
                "배추 겉절이",
                "부추무침",
                "상추 겉절이",
                "오이무침",
                "오이무침_양파",
                "오이무침_달래",
                "오이생채_부추",
                "오이생채_오이",
                "오이생채_오이_달래",
                "오이생채_오이_부추",
                "오이생채_고추장",
                "오이지무침",
                "오징어무침",
                "오징어무침_채소",
                "오징어무침_미나리",
                "오징어채무침",
                "참나물 겉절이",
                "참나물 겉절이_단감",
                "청포묵 무침",
                "치커리 겉절이",
                "탕평채",
                "파래무침_무",
                "파무침",
                "풋고추된장무침",
                "감자샐러드",
                "감자샐러드_당근",
                "겨자채",
                "닭고기 샐러드",
                "닭튀김 샐러드",
                "돌나물무침",
                "마늘쫑장아찌무침",
                "마카로니 샐러드",
                "멕시컨샐러드",
                "문어무침",
                "미나리 초무침",
                "미역 오이무침",
                "뱅어포무침",
                "부추 초무침",
                "브로콜리 두부무침",
                "브로콜리 채소무침",
                "브로콜리무침",
                "삼색냉채",
                "새싹 샐러드",
                "쑥갓무침",
                "양배추 겉절이",
                "양배추 사과 샐러드",
                "양배추부추무침",
                "양배추오이  샐러드",
                "양상추 샐러드",
                "열무 겉절이",
                "오이 도라지 생채",
                "오이고추 된장무침",
                "오징어미역초무침",
                "옥수수샐러드",
                "유채무침",
                "쥐포무침",
                "참나물 무침_된장",
                "참치 샐러드",
                "천사채무침",
                "콩나물 느타리무침",
                "콩나물냉채",
                "콩나물냉채_오이",
                "해파리냉채",
                "햄샐러드",
                "깍두기",
                "깻잎김치",
                "보쌈김치",
                "오이김치",
                "짜장소스",
                "카레소스",
                "고춧가루 양념장",
                "쌈장",
                "양념초장",
                "초간장",
                "팥빙수",
                "딸기바나나 스무디",
                "미숫가루(선식)음료",
                "수박화채",
                "계란 덮밥",
                "곤드레밥",
                "기장밥",
                "기장밥_찹쌀",
                "김밥_참치",
                "김밥_채소",
                "돼지고기 덮밥",
                "보리밥",
                "볶음밥_계란",
                "볶음밥_김치_돼지고기",
                "볶음밥_배추김치_돼지고기",
                "볶음밥_새우",
                "볶음밥_소고기",
                "볶음밥_참치_김치",
                "볶음밥_채소",
                "볶음밥_해물",
                "볶음밥_햄",
                "비빔밥",
                "비빔밥_돼지고기_양념장",
                "비빔밥_소고기_양념장",
                "비빔밥_열무",
                "비빔밥_열무_양념장",
                "비빔밥_참치",
                "비빔밥_참치_양념장",
                "수수밥",
                "쌀밥",
                "알밥",
                "영양돌솥밥",
                "오므라이스",
                "율무밥",
                "잡곡밥_보리",
                "잡곡밥_보리_흑미",
                "잡곡밥_현미",
                "잡채밥",
                "주먹밥",
                "짜장밥",
                "차조밥",
                "찰밥",
                "카레라이스_돼지고기",
                "카레라이스_돼지고기_모듬채소",
                "콩나물밥_소고기",
                "콩나물밥_양념장",
                "하이라이스",
                "현미밥",
                "현미밥_쌀",
                "흑미밥",
                "흑미밥_찹쌀",
                "강낭콩밥",
                "검정콩밥",
                "검정콩밥_보리",
                "고구마밥",
                "김치 볶음밥_모듬",
                "낙지 덮밥",
                "낙지 비빔밥",
                "닭고기 덮밥",
                "밤밥",
                "소고기 덮밥",
                "옥수수밥",
                "완두콩밥",
                "장어 덮밥",
                "채소밥",
                "팥밥",
                "혼합잡곡밥",
                "피자",
                "햄버거",
                "햄버거_치킨",
                "호떡",
                "소고기 샌드위치",
                "트위스터 샌드위치",
                "핫케이크",
                "햄샌드위치_치즈",
                "국수_열무김치",
                "떡국_달걀",
                "떡국_소고기",
                "떡국_소고기_달걀",
                "떡만두국",
                "떡만두국_고기만두",
                "라면",
                "만두국_고기만두",
                "비빔국수",
                "수제비_감자",
                "스파게티",
                "쌀국수",
                "우동",
                "자장면",
                "잔치국수",
                "짬뽕",
                "쫄면",
                "칼국수",
                "칼국수_해물",
                "고기만두",
                "군만두",
                "김치 고기만두",
                "김치만두",
                "막국수",
                "만두탕수",
                "모밀국수",
                "물냉면",
                "물만두",
                "볶음 우동",
                "어묵 우동",
                "장국국수",
                "짜장면",
                "치즈 스파게티_해물",
                "닭죽",
                "닭죽_채소",
                "소고기버섯죽",
                "참치죽",
                "팥죽",
                "호박죽",
                "감자스프",
                "흰죽",
                "갈비탕",
                "감자국",
                "곰탕",
                "굴국_두부",
                "김치국_김치_콩나물",
                "김치국_두부",
                "김치국_콩나물",
                "달걀국",
                "닭고기육개장",
                "닭곰탕",
                "된장국_근대",
                "된장국_미역",
                "된장국_시금치",
                "된장국_시래기",
                "된장국_아욱",
                "된장국_얼갈이배추",
                "된장국_유부",
                "들깨국",
                "무국_들깨",
                "무국_소고기",
                "무국_소고기_두부",
                "무국_어묵",
                "미소된장국",
                "미역국",
                "미역국_들깨",
                "미역국_북어",
                "미역국_소고기",
                "배추국",
                "배추국_들깨",
                "북어국_무",
                "북어국_무_두부",
                "북어국_콩나물",
                "북어국_달걀",
                "삼계탕",
                "새우탕",
                "소고기육개장",
                "순대국",
                "어묵국(어묵탕)_고춧가루",
                "오이냉국_미역",
                "오징어국",
                "유부국",
                "육개장_닭고기",
                "육개장_소고기",
                "육개장_돼지고기",
                "콩나물국_고춧가루",
                "콩나물국_무",
                "콩나물국_콩나물_소고기",
                "콩나물국_콩나물만",
                "콩나물국_청양고추",
                "감자 된장국_두부",
                "건새우 미역국",
                "고디국(다슬기맑은국)",
                "근대 된장국",
                "김치 콩나물국",
                "동태국",
                "냉이 된장국",
                "다슬기 된장국",
                "달래 된장국",
                "닭고기 미역국",
                "두부 달걀탕",
                "두부 된장국",
                "두부국",
                "메밀묵국",
                "무 된장국",
                "무 북어국",
                "바지락 미역국",
                "바지락국",
                "배추 된장국",
                "배추 된장국_소고기",
                "뼈다귀해장국",
                "소고기 무국",
                "소고기 미역국",
                "소고기국_무_당면",
                "시금치 된장국",
                "시래기 된장국",
                "쑥 된장국",
                "아욱 된장국",
                "애호박 감자된장국_바지락",
                "어묵국",
                "어묵탕",
                "어묵탕_고춧가루",
                "얼갈이 된장국",
                "열무 된장국",
                "올갱이해장국",
                "조개 미역국",
                "콩나물 선짓국_낙지",
                "콩나물 황태국",
                "해물 된장국",
                "호박 된장국",
                "홍합 무국",
                "홍합 미역국",
                "홍합국(홍합탕)",
                "갈치찌개",
                "감자탕",
                "고추장찌개_두부",
                "김치찌개",
                "김치찌개_돼지고기_두부",
                "김치찌개_참치",
                "김치찌개_햄",
                "꽃게탕",
                "동태찌개",
                "된장찌개",
                "된장찌개_소고기",
                "된장찌개_우렁",
                "된장찌개_모듬채소",
                "된장찌개_호박",
                "두부찌개_굴",
                "버섯전골",
                "버섯찌개",
                "부대찌개",
                "불낙전골",
                "오리탕",
                "청국장찌개_배추김치",
                "추어탕",
                "감자 소고기찌개",
                "김치 청국장찌개",
                "김치순두부",
                "김치순두부_바지락",
                "김치순두부_해물",
                "대구지리",
                "동태 매운탕",
                "돼지갈비전골",
                "두부 청국장찌개_김치",
                "버섯 매운탕",
                "어묵 매운탕",
                "참치찌개",
                "김치찜_돼지고기",
                "깻잎찜",
                "달걀찜",
                "달걀찜_당근",
                "달걀찜_새우젓",
                "닭찜_간장",
                "닭찜_매운양념",
                "돼지갈비찜",
                "돼지갈비찜_매운양념_채소",
                "돼지갈비찜_매운양념_채소_떡",
                "돼지갈비찜_채소",
                "돼지갈비찜_채소_떡",
                "돼지고기찜",
                "소갈비찜",
                "순대",
                "코다리찜",
                "돼지사태찜",
                "소사태찜",
                "연두부찜",
                "제육(돼지고기 수육)",
                "가자미구이",
                "갈치구이",
                "갈치구이_기름",
                "감자구이",
                "고등어구이",
                "고등어구이_기름",
                "고등어구이_카레",
                "굴비구이",
                "꼬치구이_닭고기",
                "꽁치구이",
                "닭구이",
                "닭날개구이",
                "닭다리구이",
                "돼지갈비구이",
                "돼지불고기_간장",
                "돼지불고기_고추장",
                "돼지불고기_버섯",
                "런천미트구이",
                "삼치구이",
                "소불고기",
                "소불고기_버섯",
                "연어구이",
                "오리고기로스",
                "오리불고기",
                "임연수구이",
                "조기구이",
                "치킨데리야끼",
                "콘치즈구이",
                "함박스테이크",
                "감자그라탕",
                "돼지고기 스테이크",
                "베이컨떡말이구이",
                "북어구이",
                "삼치 카레구이",
                "새송이버섯 구이",
                "소갈비 구이",
                "소등심 스테이크",
                "소등심구이",
                "우럭구이",
                "장어 양념구이",
                "햄구이",
                "가지전",
                "감자전",
                "김치전_해물",
                "김치전_오징어",
                "녹두빈대떡",
                "녹두빈대떡_해물_돼지고기",
                "달걀말이",
                "달걀말이_채소",
                "달걀말이_부추",
                "달걀부침(달걀후라이)",
                "동태전",
                "두부부침",
                "두부전",
                "맛살전",
                "버섯전",
                "부추전_해물",
                "스크램블드에그",
                "애호박전",
                "완자전",
                "채소전",
                "해물파전",
                "햄부침",
                "햄전",
                "호박전",
                "팥죽",
                "호박죽",
                "흑임자 죽",
                "굴죽",
                "대합죽",
                "땅콩죽",
                "복죽",
                "소고기 감자죽",
                "오리감자죽",
                "잡곡죽",
                "홍합 미나리죽",
                "홍합 소고기죽",
                "갈비탕",
                "갈비탕_소금제외",
                "감자국",
                "곰탕",
                "굴국_두부",
                "김치국",
                "김치국_콩나물",
                "내장탕",
                "달걀국",
                "닭고기육개장",
                "닭곰탕",
                "닭백숙",
                "무국",
                "무국_들깨",
                "무국_소고기",
                "무국_소고기_콩나물",
                "무국_소고기_느타리",
                "무국_어묵",
                "미소된장국",
                "미역국",
                "미역국_북어",
                "미역냉국_오이",
                "미역냉국_오이_고추",
                "배추국_들깨",
                "북어국_무",
                "북어국_콩나물",
                "북어국_달걀",
                "사골국",
                "삼계탕",
                "새우탕",
                "순대국",
                "오징어국",
                "육개장_닭고기",
                "육개장_소고기",
                "육개장_돼지고기",
                "콩나물국",
                "콩나물국_고춧가루",
                "콩나물국_김치",
                "콩나물국_청양고추",
                "토란국",
                "감자 된장국",
                "건새우 미역국",
                "고디국(다슬기맑은국)",
                "근대 된장국",
                "김국",
                "김치 된장국",
                "김치 콩나물국",
                "꼬리곰탕",
                "꼬리곰탕_당면",
                "낙지탕(맑은탕)",
                "동태국",
                "냉이 된장국",
                "다슬기 된장국",
                "닭고기 미역국",
                "두부 달걀탕",
                "두부 된장국",
                "두부 된장국_바지락",
                "두부 된장국_유부",
                "두부국",
                "메밀묵국",
                "몸국",
                "무 된장국",
                "무 북어국",
                "미역 된장국",
                "바지락 된장국",
                "바지락 미역국",
                "배추 된장국",
                "배추 된장국_바지락",
                "배추 된장국_소고기",
                "뼈다귀해장국",
                "새우젓국",
                "선지해장국_내장",
                "선짓국",
                "선짓국_내장",
                "소고기 미역국",
                "소고기 미역국_바지락",
                "소고기국_무_당면",
                "시금치 된장국",
                "시래기 된장국",
                "쑥 된장국",
                "아욱 된장국",
                "어묵국",
                "어묵국물",
                "어묵탕",
                "어묵탕_고춧가루",
                "얼갈이 된장국",
                "올갱이해장국",
                "조개 미역국",
                "조개탕",
                "참치 미역국",
                "콩나물 선짓국_낙지",
                "콩나물 황태국",
                "해물 된장국",
                "호박 된장국",
                "홍합 미역국",
                "홍합국(홍합탕)",
                "도넛",
                "또띠아",
                "롤빵",
                "마카롱",
                "버거",
                "버터빵",
                "번",
                "베이글",
                "샌드위치",
                "소보로빵",
                "소세지빵",
                "스콘",
                "식빵",
                "앙금빵",
                "야채빵",
                "와플",
                "찰떡빵",
                "츄러스",
                "치아바타",
                "치즈빵",
                "카스텔라",
                "케이크",
                "크로와상",
                "크로켓",
                "크림빵",
                "타르트",
                "토스트",
                "파이/만주",
            ],
            "category": [
                "단백질",
                "단백질",
                "단백질",
                "곡류",
                "곡류",
                "채소/지방",
                "유제품",
                "단백질",
                "단백질",
                "혼합식",
                "국/찌개",
                "혼합식",
            

            ],
            "calories": [180, 320, 260, 210, 160, 190, 180, 140, 230, 550, 60, 320],
            "protein": [35, 22, 20, 4, 2, 6, 15, 12, 18, 18, 4, 22],
            "carbs": [2, 14, 10, 44, 38, 16, 18, 4, 8, 70, 8, 30],
            "fat": [4, 18, 14, 2, 0.5, 10, 5, 6, 14, 14, 1, 8],
        }
    )

    file_path = "/mnt/data/20250408_음식DB.xlsx"
    if os.path.exists(file_path):
        try:
            df = pd.read_excel(file_path)
            # 필수 컬럼 없으면 기본값으로 보정
            needed = ["food", "calories", "protein", "carbs", "fat"]
            for col in needed:
                if col not in df.columns:
                    df[col] = default_data[col]
            if "category" not in df.columns:
                df["category"] = "기타"
            return df
        except Exception:
            return default_data
    else:
        return default_data


FOOD_DB = load_food_database()

# =============================
# 과학적 원리 설명 영역
# =============================
with st.expander("⚗️ Healicious의 영양 설계 원리", expanded=False):
    st.markdown(
        """
- **1단계 – 에너지 요구량(TDEE) 계산**  
  키·몸무게·나이·성별로 기초대사량(BMR)을 구하고, 활동량에 따라 **총 소모 칼로리(TDEE)** 를 추정합니다.

- **2단계 – 목표에 따른 칼로리 조정**  
  - 체중 감량: TDEE에서 약 **300 kcal 감소**  
  - 체중 증가: TDEE에 약 **300 kcal 증가**  
  - 근육 증가: 단백질을 늘리고, TDEE에 약 **150 kcal 증가**

- **3단계 – 거시 영양소 비율 설정**  
  하루 칼로리를 단백질·탄수화물·지방으로 나눕니다.
  - 단백질: 체중(kg) × 1.2–2.0 g  
  - 나머지 칼로리 중  
    - 체중 감량: 탄수화물 40%, 지방 60%  
    - 유지/건강: 탄수화물 50%, 지방 50%  
    - 근육 증가: 탄수화물 45%, 지방 55%

- **4단계 – 식품군 균형**  
  한 끼 안에서  
  - **단백질 식품**(닭가슴살·콩류·두부 등)  
  - **곡류/전분**(현미밥·고구마 등)  
  - **채소/과일**  
  을 최소 2~3가지 이상 섞어서 **포만감·영양·맛**을 동시에 고려합니다.
"""
    )

# =============================
# HELPER – 칼로리 & 매크로 계산
# =============================
def calculate_daily_calories(height, weight, age, gender, activity, goal):
    if gender == "남성":
        bmr = 66 + (13.7 * weight) + (5 * height) - (6.8 * age)
    else:
        bmr = 655 + (9.6 * weight) + (1.8 * height) - (4.7 * age)

    factor = {"적음": 1.2, "보통": 1.375, "많음": 1.55}[activity]
    tdee = bmr * factor

    if goal == "체중 감량":
        tdee -= 300
    elif goal == "체중 증가":
        tdee += 300
    elif goal == "근육 증가":
        tdee += 150

    # 너무 낮게 떨어지는 것 방지
    return max(1200, round(tdee))


def calculate_macro_targets(weight, calorie_target, goal):
    # 단백질(g/kg) 설정
    if goal in ["체중 감량", "체지방 감소"]:
        protein_per_kg = 1.6
        carb_ratio = 0.40
    elif goal in ["근육 증가"]:
        protein_per_kg = 2.0
        carb_ratio = 0.45
    else:  # 유지 / 체중 증가
        protein_per_kg = 1.2
        carb_ratio = 0.50

    protein_g = protein_per_kg * weight
    protein_kcal = protein_g * 4

    remaining_kcal = max(0, calorie_target - protein_kcal)
    carbs_kcal = remaining_kcal * carb_ratio
    fat_kcal = remaining_kcal - carbs_kcal

    carbs_g = carbs_kcal / 4
    fat_g = fat_kcal / 9 if fat_kcal > 0 else 0

    return {
        "protein_g": round(protein_g),
        "carbs_g": round(carbs_g),
        "fat_g": round(fat_g),
    }

# =============================
# USER INPUT SECTION
# =============================
with st.container():
    with st.expander("👤 기본 정보 입력", expanded=True):
        col1, col2 = st.columns(2)
        with col1:
            height = st.number_input("키 (cm)", min_value=100, max_value=230, value=170)
            weight = st.number_input("몸무게 (kg)", min_value=30, max_value=200, value=60)
        with col2:
            age = st.number_input("나이", min_value=10, max_value=90, value=18)
            gender = st.selectbox("성별", ["남성", "여성"])

        activity = st.selectbox("활동량", ["적음", "보통", "많음"])

        goal = st.selectbox(
            "현재 건강 목표",
            ["체중 감량", "체중 증가", "유지", "체지방 감소", "근육 증가"],
        )

    col_pref1, col_pref2 = st.columns(2)
    with col_pref1:
        preferred_food = st.text_input("좋아하는 음식 / 오늘 땡기는 음식")
        mood = st.selectbox(
            "오늘 기분",
            ["피곤함", "상쾌함", "보통", "스트레스", "기운 없음"],
        )
    with col_pref2:
        allergy = st.text_input("알레르기 (예: 땅콩, 새우 등)")
        religion = st.text_input("종교적/이념적 이유로 못 먹는 음식 (예: 돼지고기 등)")

    st.markdown("---")

# =============================
# MEAL RECOMMENDER (균형 설계)
# =============================
def filter_foods(df, preferred_food, allergy, religion):
    tmp = df.copy()

    # 선호 음식이 실제로 DB에 있으면 그쪽만 필터링
    if preferred_food:
        mask_pref = tmp["food"].astype(str).str.contains(preferred_food, na=False)
        if mask_pref.any():
            tmp = tmp[mask_pref]

    # 알레르기, 종교 제한 제외
    if allergy:
        tmp = tmp[~tmp["food"].astype(str).str.contains(allergy, na=False)]
    if religion:
        tmp = tmp[~tmp["food"].astype(str).str.contains(religion, na=False)]

    if len(tmp) == 0:
        tmp = df.copy()

    return tmp.reset_index(drop=True)


def build_meal_plan(df, calorie_target, macro_target):
    # 끼니별 칼로리 비율 (아침 30%, 점심 40%, 저녁 30%)
    ratios = {"아침": 0.3, "점심": 0.4, "저녁": 0.3}
    meals = {}

    # 밀도 계산 (단백질/탄수화물 밀도)
    df = df.copy()
    df["protein_density"] = df["protein"] / df["calories"].replace(0, np.nan)
    df["carb_density"] = df["carbs"] / df["calories"].replace(0, np.nan)

    for meal_name, r in ratios.items():
        target_kcal = calorie_target * r
        selected_rows = []

        # 단백질 식품 1개, 곡류/혼합식 1개, 기타 1개 우선 조합
        protein_candidates = df[df["category"].isin(["단백질"])].sort_values(
            "protein_density", ascending=False
        )
        carb_candidates = df[df["category"].isin(["곡류", "혼합식"])].sort_values(
            "carb_density", ascending=False
        )
        etc_candidates = df[~df["category"].isin(["단백질", "곡류"])]

        def pick_one(candidate_df):
            if len(candidate_df) == 0:
                return None
            return candidate_df.iloc[np.random.randint(0, len(candidate_df))]

        for candidate_df in [protein_candidates, carb_candidates, etc_candidates]:
            row = pick_one(candidate_df)
            if row is not None:
                selected_rows.append(row)

        # 필요시 추가 샘플링으로 칼로리 근사
        loop_guard = 0
        total_kcal = sum(rw["calories"] for rw in selected_rows)
        while total_kcal < target_kcal * 0.9 and loop_guard < 10:
            row = df.sample(1).iloc[0]
            selected_rows.append(row)
            total_kcal = sum(rw["calories"] for rw in selected_rows)
            loop_guard += 1

        if len(selected_rows) == 0:
            continue

        meal_df = (
            pd.DataFrame(selected_rows)
            .groupby("food", as_index=False)
            .agg(
                {
                    "category": "first",
                    "calories": "sum",
                    "protein": "sum",
                    "carbs": "sum",
                    "fat": "sum",
                }
            )
        )
        meals[meal_name] = meal_df

    return meals


def summarize_plan(meals):
    frames = []
    for meal_name, df in meals.items():
        tmp = df.copy()
        tmp["meal"] = meal_name
        frames.append(tmp)
    full = pd.concat(frames, ignore_index=True)
    summary = {
        "calories": int(full["calories"].sum()),
        "protein": int(full["protein"].sum()),
        "carbs": int(full["carbs"].sum()),
        "fat": int(full["fat"].sum()),
    }
    return full, summary

# =============================
# MAIN BUTTON – RUN SYSTEM
# =============================
run = st.button("🥗 오늘 식단 설계 시작하기")

if run:
    if height == 0 or weight == 0:
        st.error("키와 몸무게를 먼저 입력해 주세요.")
        st.stop()

    st.markdown("### ✅ 오늘의 맞춤 영양 설계 결과")

    calorie_target = calculate_daily_calories(height, weight, age, gender, activity, goal)
    macro_target = calculate_macro_targets(weight, calorie_target, goal)

    col_kcal, col_macro = st.columns(2)
    with col_kcal:
        st.metric("하루 권장 칼로리", f"{calorie_target} kcal")
    with col_macro:
        st.markdown(
            f"""
**매크로 목표치 (대략)**  

- 단백질: **{macro_target['protein_g']} g**  
- 탄수화물: **{macro_target['carbs_g']} g**  
- 지방: **{macro_target['fat_g']} g**
"""
        )

    base_foods = filter_foods(FOOD_DB, preferred_food, allergy, religion)
    meals = build_meal_plan(base_foods, calorie_target, macro_target)

    if len(meals) == 0:
        st.error("추천할 수 있는 식단이 없습니다. 음식 DB를 확인해 주세요.")
        st.stop()

    full_plan, summary = summarize_plan(meals)

    st.markdown("### 🍱 끼니별 추천 식단")

    for meal_name in ["아침", "점심", "저녁"]:
        df_meal = meals.get(meal_name)
        if df_meal is None or len(df_meal) == 0:
            continue

        meal_kcal = int(df_meal["calories"].sum())
        meal_protein = int(df_meal["protein"].sum())
        meal_carbs = int(df_meal["carbs"].sum())
        meal_fat = int(df_meal["fat"].sum())

        st.markdown(
            f"""
<div class="meal-card">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:4px;">
        <div>
            <div class="meal-title">{meal_name}</div>
            <div class="meal-sub">균형 잡힌 한 끼 추천</div>
        </div>
        <div class="kcal-tag">{meal_kcal} kcal</div>
    </div>
    <div class="macro-line">
        단백질 {meal_protein} g · 탄수화물 {meal_carbs} g · 지방 {meal_fat} g
    </div>
</div>
""",
            unsafe_allow_html=True,
        )

        st.table(df_meal[["food", "category", "calories", "protein", "carbs", "fat"]])

    st.markdown("### 📊 하루 전체 요약")

    col_sum1, col_sum2 = st.columns(2)
    with col_sum1:
        st.write(
            f"- 총 섭취 칼로리: **{summary['calories']} kcal** (목표 {calorie_target} kcal 근처)\n"
            f"- 총 단백질: **{summary['protein']} g** (목표 {macro_target['protein_g']} g 근처)"
        )
    with col_sum2:
        st.write(
            f"- 총 탄수화물: **{summary['carbs']} g**\n"
            f"- 총 지방: **{summary['fat']} g**"
        )

    # =============================
    # RESTAURANT RECOMMENDER (DEMO)
    # =============================
    st.markdown("### 🍽 주변 음식점 추천")

    mood_comment = {
        "피곤함": "소화가 편하고 단백질이 충분한 메뉴 위주로 구성했어요.",
        "상쾌함": "활동량을 유지할 수 있는 균형 잡힌 메뉴에 초점을 맞췄어요.",
        "보통": "과하지 않게, 하루 영양을 고르게 채우는 구성을 추천해요.",
        "스트레스": "자극적인 음식 대신, 포만감은 높고 죄책감은 적은 메뉴로 골랐어요.",
        "기운 없음": "탄수화물과 단백질을 함께 채워 에너지를 끌어올리는 구성이에요.",
    }.get(mood, "")

    if mood_comment:
        st.info(mood_comment)

    demo_restaurants = pd.DataFrame(
        {
            "음식점": ["88 SQUARE SEOUL", "1인 1잔", "청류"],
            "거리": ["158m", "88m", "218m"],
            "대표메뉴": ["닭가슴살 샐러드랩", "현미밥 + 생선구이 + 나물", "고단백 도시락"],
        }
    )

    st.dataframe(demo_restaurants)
